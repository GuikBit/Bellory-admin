import{c as I,b as V,r as l,j as e,F as f,k as c,X as B,n as X}from"./index-DUsq_Riq.js";import{u as J,a as Q,b as U,c as Y,d as Z,M as C,C as y,T as L,W as ee,E as se,S as ae,K as te,e as re}from"./template-BeWvHsen.js";import{a as o,M as ie}from"./Card-BR_6SfcG.js";import{I as le}from"./Input-Bfmmt56r.js";import{B as p}from"./Button-BTmVmhXi.js";import{E as D,S as de}from"./EmptyState-CpDH4SyR.js";import{b as oe}from"./format-EFLfV7xb.js";import{M as E}from"./mail-BaWz-xRm.js";import{S as n}from"./star-CGQv_iiC.js";import{P as F,S as ne}from"./shield-Dz8rMSm5.js";import{P as ce,a as xe,b as O}from"./power-B16wZn0d.js";import{E as me}from"./eye-BtSyNtS3.js";import{T as w}from"./triangle-alert-BCIl7Ojg.js";import{C as pe}from"./check-BnZWOmo9.js";import{R as fe}from"./receipt-DCKwk-TX.js";const he=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],M=I("copy",he);const ue=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],ge=I("ellipsis",ue),be={MessageSquare:C,Mail:E,Bell:X,KeyRound:te,Receipt:fe,AlertTriangle:w,FileText:f,Shield:ne,Star:n};function je({iconName:t,tipo:i}){const v=t?be[t]||f:f,k=i==="WHATSAPP"?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400";return e.jsx(v,{size:20,className:k})}function ve({tipo:t}){const i=re[t];return e.jsxs("span",{className:c("inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-semibold uppercase tracking-wide",i.bg,i.darkBg,i.text,i.darkText),children:[t==="WHATSAPP"?e.jsx(C,{size:10}):e.jsx(E,{size:10}),L[t]]})}function ke({categoria:t}){return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-medium bg-[#d8ccc4]/30 text-[#6b5d57] dark:bg-[#2D2925] dark:text-[#B8AEA4]",children:y[t]})}function Ie(){const{data:t,isLoading:i,error:v}=J(),k=Q(),_=U(),W=Y(),$=Z(),h=V(),[x,H]=l.useState(""),[u,R]=l.useState("TODOS"),[g,K]=l.useState("TODOS"),[a,m]=l.useState(null),[T,b]=l.useState(null),[d,N]=l.useState(null),A=l.useMemo(()=>{if(!t)return[];let s=[...t];if(x){const r=x.toLowerCase();s=s.filter(z=>z.nome.toLowerCase().includes(r)||z.codigo.toLowerCase().includes(r))}return u!=="TODOS"&&(s=s.filter(r=>r.tipo===u)),g!=="TODOS"&&(s=s.filter(r=>r.categoria===g)),s},[t,x,u,g]),j=l.useMemo(()=>t?{total:t.length,whatsapp:t.filter(s=>s.tipo==="WHATSAPP").length,email:t.filter(s=>s.tipo==="EMAIL").length,padrao:t.filter(s=>s.padrao).length}:{total:0,whatsapp:0,email:0,padrao:0},[t]),q=()=>{a&&(a.type==="desativar"?k.mutate(a.id):a.type==="ativar"?_.mutate(a.id):a.type==="padrao"&&W.mutate(a.id),m(null))},G=s=>{$.mutate({id:s.id},{onSuccess:r=>N({template:s,content:r})})},P=s=>{navigator.clipboard.writeText(s).then(()=>{})},S=s=>ae.includes(s);return v?e.jsx(D,{icon:e.jsx(f,{size:48}),title:"Erro ao carregar",description:"Não foi possível carregar os templates."}):e.jsxs("div",{className:"space-y-5",children:[!i&&t&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs(o,{className:"p-4",children:[e.jsx("p",{className:"text-xs font-medium text-[#6b5d57] dark:text-[#7A716A] uppercase tracking-wider",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold text-[#2a2420] dark:text-[#F5F0EB] mt-1",children:j.total})]}),e.jsxs(o,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(C,{size:12,className:"text-green-600 dark:text-green-400"}),e.jsx("p",{className:"text-xs font-medium text-green-600 dark:text-green-400 uppercase tracking-wider",children:"WhatsApp"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400 mt-1",children:j.whatsapp})]}),e.jsxs(o,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(E,{size:12,className:"text-blue-600 dark:text-blue-400"}),e.jsx("p",{className:"text-xs font-medium text-blue-600 dark:text-blue-400 uppercase tracking-wider",children:"E-mail"})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400 mt-1",children:j.email})]}),e.jsxs(o,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(n,{size:12,className:"text-amber-500"}),e.jsx("p",{className:"text-xs font-medium text-amber-600 dark:text-amber-400 uppercase tracking-wider",children:"Padrão"})]}),e.jsx("p",{className:"text-2xl font-bold text-amber-600 dark:text-amber-400 mt-1",children:j.padrao})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx(le,{placeholder:"Buscar por nome ou código...",value:x,onChange:s=>H(s.target.value),leftIcon:e.jsx(de,{size:18})})}),e.jsxs(p,{variant:"primary",onClick:()=>h("/templates/novo"),leftIcon:e.jsx(F,{size:16}),children:[e.jsx("span",{className:"hidden sm:inline",children:"Novo Template"}),e.jsx("span",{className:"sm:hidden",children:"Novo"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[e.jsx("div",{className:"flex gap-1 bg-[#faf8f6] dark:bg-[#0D0B0A] rounded-lg p-1",children:["TODOS","WHATSAPP","EMAIL"].map(s=>e.jsx("button",{onClick:()=>R(s),className:c("px-3 py-1.5 rounded-md text-xs font-medium transition-all duration-200",u===s?"bg-white dark:bg-[#1A1715] text-[#2a2420] dark:text-[#F5F0EB] shadow-sm":"text-[#6b5d57] dark:text-[#7A716A] hover:text-[#2a2420] dark:hover:text-[#F5F0EB]"),children:s==="TODOS"?"Todos":s==="WHATSAPP"?"WhatsApp":"E-mail"},s))}),e.jsxs("select",{value:g,onChange:s=>K(s.target.value),className:"h-9 px-3 rounded-lg border border-[#d8ccc4] dark:border-[#2D2925] bg-white dark:bg-[#1A1715] text-[#2a2420] dark:text-[#F5F0EB] text-sm focus:outline-none focus:border-[#db6f57] dark:focus:border-[#E07A62]",children:[e.jsx("option",{value:"TODOS",children:"Todas categorias"}),Object.entries(y).map(([s,r])=>e.jsx("option",{value:s,children:r},s))]}),e.jsx("span",{className:"text-sm text-[#6b5d57] dark:text-[#7A716A] ml-auto",children:i?"Carregando...":`${A.length} templates`})]})]}),i?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:Array.from({length:6}).map((s,r)=>e.jsx(ie,{},r))}):A.length===0?e.jsx(D,{icon:e.jsx(f,{size:48}),title:"Nenhum template",description:x?"Nenhum resultado para sua busca.":"Nenhum template cadastrado ainda.",action:e.jsx(p,{onClick:()=>h("/templates/novo"),leftIcon:e.jsx(F,{size:16}),children:"Criar primeiro template"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:A.map(s=>e.jsxs(o,{hover:!0,className:c("relative overflow-hidden cursor-pointer",!s.ativo&&"opacity-60"),onClick:()=>h(`/templates/${s.id}`),children:[S(s.codigo)&&e.jsx("div",{className:"absolute top-0 right-0",children:e.jsx("div",{className:"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 text-[9px] font-semibold uppercase tracking-wider px-2 py-0.5 rounded-bl-lg",children:"Seed"})}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:c("w-10 h-10 rounded-lg flex items-center justify-center shrink-0",s.tipo==="WHATSAPP"?"bg-green-100 dark:bg-green-900/20":"bg-blue-100 dark:bg-blue-900/20"),children:e.jsx(je,{iconName:s.icone,tipo:s.tipo})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-[#2a2420] dark:text-[#F5F0EB] truncate",children:s.nome}),s.padrao&&e.jsx(n,{size:12,className:"text-amber-500 fill-amber-500 shrink-0"})]}),e.jsx("code",{className:"text-[10px] font-mono text-[#6b5d57] dark:text-[#7A716A]",children:s.codigo})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 mb-3",children:[e.jsx(ve,{tipo:s.tipo}),e.jsx(ke,{categoria:s.categoria}),s.padrao&&e.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 rounded-full text-[10px] font-semibold bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",children:[e.jsx(n,{size:9,className:"fill-current"}),"Padrão"]})]}),s.tipo==="EMAIL"&&s.assunto&&e.jsxs("p",{className:"text-xs text-[#6b5d57] dark:text-[#B8AEA4] mb-2 truncate",children:[e.jsx("span",{className:"font-medium",children:"Assunto:"})," ",s.assunto]}),e.jsxs("p",{className:"text-xs text-[#6b5d57] dark:text-[#7A716A] line-clamp-2 leading-relaxed mb-3",children:[s.conteudo.replace(/\*|_|~|{{|}}/g,"").slice(0,120),s.conteudo.length>120?"...":""]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-[#d8ccc4]/50 dark:border-[#2D2925]/50",children:[e.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-[#6b5d57] dark:text-[#7A716A]",children:[e.jsxs("span",{children:[s.variaveisDisponiveis.length," variáveis"]}),e.jsx("span",{children:oe(s.dtCriacao)})]}),e.jsxs("div",{className:"relative flex items-center gap-0.5",onClick:r=>r.stopPropagation(),children:[e.jsx("button",{onClick:()=>h(`/templates/${s.id}`),className:"p-1.5 rounded-md text-[#6b5d57] dark:text-[#B8AEA4] hover:text-[#db6f57] dark:hover:text-[#E07A62] hover:bg-[#faf8f6] dark:hover:bg-[#2D2925] transition-colors",title:"Editar",children:e.jsx(ce,{size:14})}),e.jsx("button",{onClick:()=>G(s),className:"p-1.5 rounded-md text-[#6b5d57] dark:text-[#B8AEA4] hover:text-[#4f6f64] dark:hover:text-[#6B8F82] hover:bg-[#faf8f6] dark:hover:bg-[#2D2925] transition-colors",title:"Preview",children:e.jsx(me,{size:14})}),e.jsx("button",{onClick:()=>b(T===s.id?null:s.id),className:"p-1.5 rounded-md text-[#6b5d57] dark:text-[#B8AEA4] hover:bg-[#faf8f6] dark:hover:bg-[#2D2925] transition-colors",title:"Mais ações",children:e.jsx(ge,{size:14})}),T===s.id&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>b(null)}),e.jsxs("div",{className:"absolute right-0 top-8 z-20 w-48 bg-white dark:bg-[#1A1715] rounded-lg border border-[#d8ccc4] dark:border-[#2D2925] shadow-lg py-1",children:[!s.padrao&&s.ativo&&e.jsxs("button",{onClick:()=>{b(null),m({id:s.id,type:"padrao",template:s})},className:"flex items-center gap-2 w-full px-3 py-2 text-xs text-[#2a2420] dark:text-[#F5F0EB] hover:bg-[#faf8f6] dark:hover:bg-[#2D2925] transition-colors",children:[e.jsx(n,{size:13}),"Marcar como Padrão"]}),e.jsxs("button",{onClick:()=>P(s.conteudo),className:"flex items-center gap-2 w-full px-3 py-2 text-xs text-[#2a2420] dark:text-[#F5F0EB] hover:bg-[#faf8f6] dark:hover:bg-[#2D2925] transition-colors",children:[e.jsx(M,{size:13}),"Copiar conteúdo"]}),e.jsx("div",{className:"border-t border-[#d8ccc4] dark:border-[#2D2925] my-1"}),e.jsxs("button",{onClick:()=>{b(null),m({id:s.id,type:s.ativo?"desativar":"ativar",template:s})},className:c("flex items-center gap-2 w-full px-3 py-2 text-xs transition-colors",s.ativo?"text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20":"text-[#4f6f64] dark:text-[#6B8F82] hover:bg-[#4f6f64]/10"),children:[s.ativo?e.jsx(xe,{size:13}):e.jsx(O,{size:13}),s.ativo?"Desativar":"Ativar"]})]})]})]})]})]})]},s.id))}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>m(null),children:e.jsxs(o,{className:"w-full max-w-sm p-6",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:c("w-10 h-10 rounded-full flex items-center justify-center",a.type==="desativar"?"bg-red-100 dark:bg-red-900/30":a.type==="padrao"?"bg-amber-100 dark:bg-amber-900/30":"bg-[#4f6f64]/15 dark:bg-[#6B8F82]/15"),children:a.type==="desativar"?e.jsx(w,{size:20,className:"text-red-500 dark:text-red-400"}):a.type==="padrao"?e.jsx(n,{size:20,className:"text-amber-600 dark:text-amber-400"}):e.jsx(O,{size:20,className:"text-[#4f6f64] dark:text-[#6B8F82]"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-[#2a2420] dark:text-[#F5F0EB]",children:a.type==="desativar"?"Desativar template":a.type==="padrao"?"Marcar como padrão":"Ativar template"}),e.jsx("p",{className:"text-sm text-[#6b5d57] dark:text-[#B8AEA4]",children:a.type==="desativar"?`"${a.template.nome}" será desativado.`:a.type==="padrao"?`Isso vai desmarcar o padrão atual para ${L[a.template.tipo]} - ${y[a.template.categoria]}.`:`"${a.template.nome}" será reativado.`})]})]}),a.type==="desativar"&&S(a.template.codigo)&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 mb-4 rounded-lg bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 text-xs",children:[e.jsx(w,{size:14}),"Este é um template seed essencial do sistema."]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(p,{variant:"ghost",onClick:()=>m(null),children:"Cancelar"}),e.jsx(p,{variant:a.type==="desativar"?"danger":a.type==="padrao"?"primary":"secondary",onClick:q,leftIcon:a.type==="desativar"?e.jsx(B,{size:16}):a.type==="padrao"?e.jsx(n,{size:16}):e.jsx(pe,{size:16}),children:a.type==="desativar"?"Desativar":a.type==="padrao"?"Confirmar":"Ativar"})]})]})}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>N(null),children:e.jsxs(o,{className:"w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-[#d8ccc4] dark:border-[#2D2925] shrink-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-[#2a2420] dark:text-[#F5F0EB]",children:"Preview"}),e.jsx("p",{className:"text-xs text-[#6b5d57] dark:text-[#7A716A]",children:d.template.nome})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{size:"sm",variant:"ghost",onClick:()=>P(d.content),leftIcon:e.jsx(M,{size:14}),children:"Copiar"}),e.jsx("button",{onClick:()=>N(null),className:"p-1.5 rounded-lg text-[#6b5d57] hover:bg-[#faf8f6] dark:hover:bg-[#2D2925]",children:e.jsx(B,{size:18})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-5",children:d.template.tipo==="WHATSAPP"?e.jsx(ee,{text:d.content}):e.jsx(se,{html:d.content,assunto:d.template.assunto||void 0})})]})})]})}export{Ie as TemplatesList};
