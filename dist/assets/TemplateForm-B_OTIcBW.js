import{j as e,k as b,X as ae,b as re,l as oe,r as x,n as le,F as ne}from"./index-DUsq_Riq.js";import{f as de,g as ie,h as ce,T as xe,M as G,C as me,K as ue,V as be,i as pe,W as he,E as ge}from"./template-BeWvHsen.js";import{S as k,a as N,c as w,b as y}from"./Card-BR_6SfcG.js";import{I}from"./Input-Bfmmt56r.js";import{B as p}from"./Button-BTmVmhXi.js";import{a as $,S as fe}from"./sparkles-rz-8_avv.js";import{P as q,S as je}from"./shield-Dz8rMSm5.js";import{A as ve}from"./arrow-left-CZk9JZJZ.js";import{E as P}from"./eye-BtSyNtS3.js";import{M as K}from"./mail-BaWz-xRm.js";import{R as Ae}from"./receipt-DCKwk-TX.js";import{T as ke}from"./triangle-alert-BCIl7Ojg.js";import{S as Ne}from"./star-CGQv_iiC.js";import"./check-BnZWOmo9.js";function Ee({variavel:a,tipoTemplate:d,onClick:r}){const l=d==="WHATSAPP"?`{{${a.nome}}}`:`\${${a.nome}}`;return e.jsx("button",{type:"button",onClick:()=>r(l),className:b("inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-mono transition-all duration-200 border","hover:shadow-sm active:scale-95",d==="WHATSAPP"?"bg-green-50 text-green-700 border-green-200 hover:bg-green-100 dark:bg-green-900/20 dark:text-green-400 dark:border-green-800 dark:hover:bg-green-900/30":"bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100 dark:bg-blue-900/20 dark:text-blue-400 dark:border-blue-800 dark:hover:bg-blue-900/30"),title:`${a.descricao} ‚Äî ex: ${a.exemplo}`,children:l})}function Se({value:a,onChange:d,sugestoes:r}){const l=()=>d([...a,{nome:"",descricao:"",exemplo:""}]),s=i=>d(a.filter((c,o)=>o!==i)),j=(i,c,o)=>{const h=[...a];h[i]={...h[i],[c]:o},d(h)},v=()=>{if(!r)return;const i=new Set(a.map(o=>o.nome)),c=r.filter(o=>!i.has(o.nome));d([...a,...c])};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs font-medium text-[#6b5d57] dark:text-[#7A716A] uppercase tracking-wider",children:[a.length," ",a.length===1?"vari√°vel":"vari√°veis"]}),e.jsxs("div",{className:"flex gap-2",children:[r&&r.length>0&&e.jsx(p,{size:"sm",variant:"ghost",onClick:v,leftIcon:e.jsx($,{size:13}),children:"Carregar sugest√µes"}),e.jsx(p,{size:"sm",variant:"outline",onClick:l,leftIcon:e.jsx(q,{size:13}),children:"Adicionar"})]})]}),a.length===0?e.jsxs("div",{className:"text-center py-6 border border-dashed border-[#d8ccc4] dark:border-[#2D2925] rounded-lg",children:[e.jsx("p",{className:"text-sm text-[#6b5d57] dark:text-[#7A716A] mb-2",children:"Nenhuma vari√°vel adicionada"}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[r&&r.length>0&&e.jsx(p,{size:"sm",variant:"ghost",onClick:v,leftIcon:e.jsx($,{size:13}),children:"Carregar sugest√µes"}),e.jsx(p,{size:"sm",variant:"outline",onClick:l,leftIcon:e.jsx(q,{size:13}),children:"Adicionar vari√°vel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden sm:grid grid-cols-[1fr_1fr_1fr_32px] gap-2 px-1",children:[e.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wider text-[#6b5d57] dark:text-[#7A716A]",children:"Nome"}),e.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wider text-[#6b5d57] dark:text-[#7A716A]",children:"Descri√ß√£o"}),e.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wider text-[#6b5d57] dark:text-[#7A716A]",children:"Exemplo"}),e.jsx("span",{})]}),a.map((i,c)=>e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_1fr_1fr_32px] gap-2 group",children:[e.jsx("input",{type:"text",value:i.nome,onChange:o=>j(c,"nome",o.target.value),placeholder:"nome_variavel",className:"h-8 px-2.5 rounded-lg border border-[#d8ccc4] dark:border-[#2D2925] bg-white dark:bg-[#1A1715] text-[#2a2420] dark:text-[#F5F0EB] text-xs font-mono placeholder:text-[#6b5d57]/50 dark:placeholder:text-[#7A716A] focus:outline-none focus:border-[#db6f57] dark:focus:border-[#E07A62] transition-colors"}),e.jsx("input",{type:"text",value:i.descricao,onChange:o=>j(c,"descricao",o.target.value),placeholder:"Descri√ß√£o",className:"h-8 px-2.5 rounded-lg border border-[#d8ccc4] dark:border-[#2D2925] bg-white dark:bg-[#1A1715] text-[#2a2420] dark:text-[#F5F0EB] text-xs placeholder:text-[#6b5d57]/50 dark:placeholder:text-[#7A716A] focus:outline-none focus:border-[#db6f57] dark:focus:border-[#E07A62] transition-colors"}),e.jsx("input",{type:"text",value:i.exemplo,onChange:o=>j(c,"exemplo",o.target.value),placeholder:"Valor exemplo",className:"h-8 px-2.5 rounded-lg border border-[#d8ccc4] dark:border-[#2D2925] bg-white dark:bg-[#1A1715] text-[#2a2420] dark:text-[#F5F0EB] text-xs placeholder:text-[#6b5d57]/50 dark:placeholder:text-[#7A716A] focus:outline-none focus:border-[#db6f57] dark:focus:border-[#E07A62] transition-colors"}),e.jsx("button",{type:"button",onClick:()=>s(c),className:"h-8 w-8 flex items-center justify-center rounded-lg text-[#6b5d57] dark:text-[#7A716A] hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors opacity-0 group-hover:opacity-100 sm:opacity-0 sm:group-hover:opacity-100 max-sm:opacity-100",children:e.jsx(ae,{size:14})})]},c))]})]})}const Ce=[{value:"MessageSquare",label:"Mensagem",Icon:G},{value:"Bell",label:"Sino",Icon:le},{value:"Mail",label:"E-mail",Icon:K},{value:"KeyRound",label:"Chave",Icon:ue},{value:"Receipt",label:"Recibo",Icon:Ae},{value:"AlertTriangle",label:"Alerta",Icon:ke},{value:"FileText",label:"Documento",Icon:ne},{value:"Shield",label:"Escudo",Icon:je},{value:"Star",label:"Estrela",Icon:Ne}],we=["CONFIRMACAO","LEMBRETE","BEM_VINDO","RESET_SENHA","COBRANCA_AVISO","COBRANCA_LEMBRETE"];function ye(a,d,r){let l=a;for(const s of d)r==="WHATSAPP"?l=l.replace(new RegExp(`\\{\\{${s.nome}\\}\\}`,"g"),s.exemplo):l=l.replace(new RegExp(`\\$\\{${s.nome}\\}`,"g"),s.exemplo);return l}function We(){const a=re(),{id:d}=oe(),r=!!d&&d!=="novo",l=r?Number(d):0,{data:s,isLoading:j}=de(l),v=ie(),i=ce(),c=x.useRef(null),[o,h]=x.useState(""),[F,T]=x.useState(""),[B,D]=x.useState(""),[n,z]=x.useState("WHATSAPP"),[R,M]=x.useState("CONFIRMACAO"),[E,_]=x.useState(""),[m,S]=x.useState(""),[L,O]=x.useState("MessageSquare"),[g,V]=x.useState([]),[A,U]=x.useState(!0),[f,X]=x.useState({});x.useEffect(()=>{s&&(h(s.codigo),T(s.nome),D(s.descricao||""),z(s.tipo),M(s.categoria),_(s.assunto||""),S(s.conteudo),O(s.icone||"MessageSquare"),V(s.variaveisDisponiveis||[]))},[s]);const J=()=>{const t={};return o.trim()||(t.codigo="C√≥digo √© obrigat√≥rio"),F.trim()||(t.nome="Nome √© obrigat√≥rio"),m.trim()||(t.conteudo="Conte√∫do √© obrigat√≥rio"),n==="EMAIL"&&!E.trim()&&(t.assunto="Assunto √© obrigat√≥rio para e-mail"),X(t),Object.keys(t).length===0},Q=()=>{if(!J())return;const t={codigo:o.trim().toLowerCase(),nome:F.trim(),descricao:B.trim()||void 0,tipo:n,categoria:R,assunto:n==="EMAIL"?E.trim():void 0,conteudo:m.trim(),variaveisDisponiveis:g.length>0?g:void 0,icone:L||void 0};r?i.mutate({id:l,data:t},{onSuccess:()=>a("/templates")}):v.mutate(t,{onSuccess:()=>a("/templates")})},Y=t=>{const u=c.current;if(!u){S(C=>C+t);return}const W=u.selectionStart,te=u.selectionEnd,se=m.slice(0,W)+t+m.slice(te);S(se),requestAnimationFrame(()=>{u.focus();const C=W+t.length;u.setSelectionRange(C,C)})},H=ye(m,g,n),Z=n==="WHATSAPP"?be:pe,ee=v.isPending||i.isPending;return r&&j?e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{className:"h-10 w-10"}),e.jsx(k,{className:"h-6 w-48"})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-5",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-5",children:[e.jsx(k,{className:"h-64 w-full rounded-xl"}),e.jsx(k,{className:"h-48 w-full rounded-xl"})]}),e.jsx(k,{className:"h-96 w-full rounded-xl"})]})]}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>a("/templates"),className:"p-2 rounded-lg text-[#6b5d57] dark:text-[#B8AEA4] hover:bg-[#faf8f6] dark:hover:bg-[#2D2925] transition-colors",children:e.jsx(ve,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-[#2a2420] dark:text-[#F5F0EB]",children:r?"Editar Template":"Novo Template"}),e.jsx("p",{className:"text-sm text-[#6b5d57] dark:text-[#7A716A]",children:r?`Editando "${s?.nome||""}"`:"Preencha os dados para criar um novo template"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{variant:"outline",onClick:()=>U(!A),leftIcon:e.jsx(P,{size:16}),className:"hidden xl:inline-flex",children:A?"Ocultar":"Preview"}),e.jsx(p,{variant:"ghost",onClick:()=>a("/templates"),children:"Cancelar"}),e.jsx(p,{variant:"primary",onClick:Q,isLoading:ee,leftIcon:e.jsx(fe,{size:16}),children:r?"Salvar":"Criar Template"})]})]}),e.jsxs("div",{className:b("grid grid-cols-1 gap-5",A&&"xl:grid-cols-3"),children:[e.jsxs("div",{className:b("space-y-5",A?"xl:col-span-2":""),children:[e.jsxs(N,{children:[e.jsx(w,{children:e.jsx("h2",{className:"text-sm font-semibold text-[#2a2420] dark:text-[#F5F0EB]",children:"Informa√ß√µes B√°sicas"})}),e.jsx(y,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(I,{label:"C√≥digo",placeholder:"ex: whatsapp-confirmacao-v2",value:o,onChange:t=>h(t.target.value.toLowerCase().replace(/[^a-z0-9_-]/g,"")),error:f.codigo}),e.jsx(I,{label:"Nome",placeholder:"ex: Confirma√ß√£o de Agendamento V2",value:F,onChange:t=>T(t.target.value),error:f.nome}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#2a2420] dark:text-[#F5F0EB] mb-1.5",children:"Tipo"}),e.jsx("div",{className:"flex gap-2",children:["WHATSAPP","EMAIL"].map(t=>e.jsxs("button",{type:"button",onClick:()=>z(t),className:b("flex-1 flex items-center justify-center gap-2 h-10 rounded-lg border text-sm font-medium transition-all duration-200",n===t?t==="WHATSAPP"?"border-green-500 bg-green-50 text-green-700 dark:border-green-600 dark:bg-green-900/20 dark:text-green-400":"border-blue-500 bg-blue-50 text-blue-700 dark:border-blue-600 dark:bg-blue-900/20 dark:text-blue-400":"border-[#d8ccc4] dark:border-[#2D2925] text-[#6b5d57] dark:text-[#B8AEA4] hover:border-[#db6f57]/50 dark:hover:border-[#E07A62]/50"),children:[t==="WHATSAPP"?e.jsx(G,{size:16}):e.jsx(K,{size:16}),xe[t]]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#2a2420] dark:text-[#F5F0EB] mb-1.5",children:"Categoria"}),e.jsx("select",{value:R,onChange:t=>M(t.target.value),className:"w-full h-10 px-3 rounded-lg border border-[#d8ccc4] dark:border-[#2D2925] bg-white dark:bg-[#1A1715] text-[#2a2420] dark:text-[#F5F0EB] text-sm focus:outline-none focus:border-[#db6f57] dark:focus:border-[#E07A62]",children:we.map(t=>e.jsx("option",{value:t,children:me[t]},t))})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-[#2a2420] dark:text-[#F5F0EB] mb-1.5",children:"Descri√ß√£o interna"}),e.jsx("textarea",{value:B,onChange:t=>D(t.target.value),placeholder:"Descri√ß√£o interna do template (n√£o aparece na mensagem)...",rows:2,className:"w-full px-3 py-2 rounded-lg border border-[#d8ccc4] dark:border-[#2D2925] bg-white dark:bg-[#1A1715] text-[#2a2420] dark:text-[#F5F0EB] placeholder:text-[#6b5d57]/50 dark:placeholder:text-[#7A716A] text-sm focus:outline-none focus:border-[#db6f57] dark:focus:border-[#E07A62] focus:ring-2 focus:ring-[#db6f57]/20 dark:focus:ring-[#E07A62]/20 resize-none transition-colors"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-[#2a2420] dark:text-[#F5F0EB] mb-2",children:"√çcone"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ce.map(t=>e.jsxs("button",{type:"button",onClick:()=>O(t.value),className:b("flex items-center gap-2 px-3 py-2 rounded-lg border text-sm transition-all duration-200",L===t.value?"border-[#db6f57] bg-[#db6f57]/10 text-[#db6f57] dark:border-[#E07A62] dark:bg-[#E07A62]/10 dark:text-[#E07A62]":"border-[#d8ccc4] dark:border-[#2D2925] text-[#6b5d57] dark:text-[#B8AEA4] hover:border-[#db6f57]/50 dark:hover:border-[#E07A62]/50"),title:t.label,children:[e.jsx(t.Icon,{size:16}),e.jsx("span",{className:"hidden sm:inline text-xs",children:t.label})]},t.value))})]})]})})]}),e.jsxs(N,{children:[e.jsx(w,{children:e.jsx("h2",{className:"text-sm font-semibold text-[#2a2420] dark:text-[#F5F0EB]",children:"Conte√∫do da Mensagem"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[n==="EMAIL"&&e.jsx(I,{label:"Assunto do E-mail",placeholder:"ex: Confirma√ß√£o de agendamento - Bellory",value:E,onChange:t=>_(t.target.value),error:f.assunto}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-[#2a2420] dark:text-[#F5F0EB]",children:n==="WHATSAPP"?"Mensagem WhatsApp":"Conte√∫do HTML do E-mail"}),n==="WHATSAPP"&&e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-[#6b5d57] dark:text-[#7A716A]",children:[e.jsx("span",{children:e.jsx("strong",{children:"*bold*"})}),e.jsx("span",{children:e.jsx("em",{children:"_italic_"})}),e.jsx("span",{children:e.jsx("del",{children:"~riscado~"})})]})]}),e.jsx("textarea",{ref:c,value:m,onChange:t=>S(t.target.value),placeholder:n==="WHATSAPP"?`Ol√° *{{nome_cliente}}*! üëã

Seu agendamento est√° confirmado...`:`<html>
<body>
  <h1>Ol√° \${nomeCliente}</h1>
</body>
</html>`,rows:n==="EMAIL"?14:10,className:b("w-full px-3 py-2 rounded-lg border bg-white text-sm transition-colors resize-y","border-[#d8ccc4] dark:border-[#2D2925] dark:bg-[#1A1715] text-[#2a2420] dark:text-[#F5F0EB]","placeholder:text-[#6b5d57]/50 dark:placeholder:text-[#7A716A]","focus:outline-none focus:border-[#db6f57] dark:focus:border-[#E07A62] focus:ring-2 focus:ring-[#db6f57]/20 dark:focus:ring-[#E07A62]/20",n==="EMAIL"&&"font-mono text-xs",f.conteudo&&"border-red-500 dark:border-red-500")}),f.conteudo&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:f.conteudo})]}),g.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-[#6b5d57] dark:text-[#7A716A] mb-2",children:"Clique para inserir no conte√∫do:"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:g.map((t,u)=>e.jsx(Ee,{variavel:t,tipoTemplate:n,onClick:Y},u))})]})]})})]}),e.jsxs(N,{children:[e.jsx(w,{children:e.jsx("h2",{className:"text-sm font-semibold text-[#2a2420] dark:text-[#F5F0EB]",children:"Vari√°veis Dispon√≠veis"})}),e.jsx(y,{children:e.jsx(Se,{value:g,onChange:V,sugestoes:Z})})]})]}),A&&e.jsxs("div",{className:"xl:sticky xl:top-20 xl:self-start space-y-4",children:[e.jsxs(N,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{size:16,className:"text-[#6b5d57] dark:text-[#7A716A]"}),e.jsx("h2",{className:"text-sm font-semibold text-[#2a2420] dark:text-[#F5F0EB]",children:"Preview ao Vivo"})]})}),e.jsx(y,{children:m?n==="WHATSAPP"?e.jsx(he,{text:H}):e.jsx(ge,{html:H,assunto:E||void 0}):e.jsxs("div",{className:"text-center py-12 text-[#6b5d57] dark:text-[#7A716A]",children:[e.jsx(P,{size:32,className:"mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-sm",children:"Digite o conte√∫do para ver o preview"})]})})]}),r&&s&&e.jsxs(N,{className:"p-4",children:[e.jsx("p",{className:"text-xs font-medium text-[#6b5d57] dark:text-[#7A716A] uppercase tracking-wider mb-2",children:"Informa√ß√µes"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#6b5d57] dark:text-[#7A716A]",children:"Status"}),e.jsx("span",{className:b("inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-medium",s.ativo?"bg-[#4f6f64]/15 text-[#4f6f64] dark:bg-[#6B8F82]/15 dark:text-[#6B8F82]":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"),children:s.ativo?"Ativo":"Inativo"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#6b5d57] dark:text-[#7A716A]",children:"Padr√£o"}),e.jsx("span",{className:"text-[#2a2420] dark:text-[#F5F0EB]",children:s.padrao?"Sim":"N√£o"})]}),s.dtCriacao&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#6b5d57] dark:text-[#7A716A]",children:"Criado em"}),e.jsx("span",{className:"text-[#2a2420] dark:text-[#F5F0EB]",children:new Date(s.dtCriacao).toLocaleDateString("pt-BR")})]}),s.dtAtualizacao&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#6b5d57] dark:text-[#7A716A]",children:"Atualizado em"}),e.jsx("span",{className:"text-[#2a2420] dark:text-[#F5F0EB]",children:new Date(s.dtAtualizacao).toLocaleDateString("pt-BR")})]})]})]})]})]})]})}export{We as TemplateForm};
