import{c as K,b as Q,r as o,j as e,g as u,B as P,k as j,X as W}from"./index-DUsq_Riq.js";import{u as Y,a as ee,b as te,c as se,C as O,d as I,G as ae,H as re,R as ie,e as ce,Z as de,f as oe}from"./usePlanos-Ca78MHAO.js";import{a as d,T as le}from"./Card-BR_6SfcG.js";import{I as ne}from"./Input-Bfmmt56r.js";import{B as D}from"./Badge-CxxU2TNm.js";import{B as l}from"./Button-BTmVmhXi.js";import{E as U,S as xe}from"./EmptyState-CpDH4SyR.js";import{f as M,a as y}from"./format-EFLfV7xb.js";import{F as me}from"./funnel-ORKn1Ux1.js";import{S as he,a as fe}from"./sparkles-rz-8_avv.js";import{P as L,S as pe}from"./shield-Dz8rMSm5.js";import{S as w}from"./star-CGQv_iiC.js";import{P as $,a as R,b as C}from"./power-B16wZn0d.js";import{T as je}from"./triangle-alert-BCIl7Ojg.js";import{C as ue}from"./check-BnZWOmo9.js";const ve=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],ge=K("grip-vertical",ve),be={Gift:oe,Zap:de,Sparkles:fe,Crown:ce,Star:w,Rocket:ie,Heart:re,Shield:pe,Gem:ae,CreditCard:u};function T({iconName:a,cor:n}){const b=a?be[a]||u:u;return e.jsx(b,{size:20,style:n?{color:n}:void 0})}function Ue(){const{data:a,isLoading:n,error:b}=Y(),G=ee(),_=te(),z=se(),x=Q(),[m,H]=o.useState(""),[v,Z]=o.useState("all"),[E,V]=o.useState(!1),[r,h]=o.useState(null),[i,k]=o.useState(!1),[f,N]=o.useState([]),A=o.useMemo(()=>{if(!a)return[];let t=[...a].sort((s,c)=>(s.ordemExibicao??999)-(c.ordemExibicao??999));if(m){const s=m.toLowerCase();t=t.filter(c=>c.nome.toLowerCase().includes(s)||c.codigo.toLowerCase().includes(s))}return v==="ativo"&&(t=t.filter(s=>s.ativo)),v==="inativo"&&(t=t.filter(s=>!s.ativo)),t},[a,m,v]),p=i?f:A,X=()=>{N([...A]),k(!0)},B=t=>{if(t===0)return;const s=[...f];[s[t-1],s[t]]=[s[t],s[t-1]],N(s)},F=t=>{if(t===f.length-1)return;const s=[...f];[s[t],s[t+1]]=[s[t+1],s[t]],N(s)},q=()=>{z.mutate({planos:f.map((t,s)=>({id:t.id,ordemExibicao:s+1}))},{onSuccess:()=>k(!1)})},S=t=>{if(t.ativo){if(t.totalOrganizacoesUsando>0)return;h({id:t.id,type:"desativar"})}else h({id:t.id,type:"ativar"})},J=()=>{r&&(r.type==="desativar"?G.mutate(r.id):_.mutate(r.id),h(null))},g=o.useMemo(()=>a?{total:a.length,ativos:a.filter(t=>t.ativo).length,inativos:a.filter(t=>!t.ativo).length,totalOrgs:a.reduce((t,s)=>t+s.totalOrganizacoesUsando,0)}:{total:0,ativos:0,inativos:0,totalOrgs:0},[a]);return b?e.jsx(U,{icon:e.jsx(u,{size:48}),title:"Erro ao carregar",description:"Não foi possível carregar os planos."}):e.jsxs("div",{className:"space-y-5",children:[!n&&a&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs(d,{className:"p-4",children:[e.jsx("p",{className:"text-xs font-medium text-[#6b5d57] dark:text-[#7A716A] uppercase tracking-wider",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold text-[#2a2420] dark:text-[#F5F0EB] mt-1",children:g.total})]}),e.jsxs(d,{className:"p-4",children:[e.jsx("p",{className:"text-xs font-medium text-[#4f6f64] dark:text-[#6B8F82] uppercase tracking-wider",children:"Ativos"}),e.jsx("p",{className:"text-2xl font-bold text-[#4f6f64] dark:text-[#6B8F82] mt-1",children:g.ativos})]}),e.jsxs(d,{className:"p-4",children:[e.jsx("p",{className:"text-xs font-medium text-red-500 dark:text-red-400 uppercase tracking-wider",children:"Inativos"}),e.jsx("p",{className:"text-2xl font-bold text-red-500 dark:text-red-400 mt-1",children:g.inativos})]}),e.jsxs(d,{className:"p-4",children:[e.jsx("p",{className:"text-xs font-medium text-[#db6f57] dark:text-[#E07A62] uppercase tracking-wider",children:"Organizações"}),e.jsx("p",{className:"text-2xl font-bold text-[#db6f57] dark:text-[#E07A62] mt-1",children:M(g.totalOrgs)})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx(ne,{placeholder:"Buscar por nome ou código...",value:m,onChange:t=>H(t.target.value),leftIcon:e.jsx(xe,{size:18})})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"outline",onClick:()=>V(!E),leftIcon:e.jsx(me,{size:16}),children:"Filtros"}),i?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"secondary",onClick:q,isLoading:z.isPending,leftIcon:e.jsx(he,{size:16}),children:"Salvar"}),e.jsx(l,{variant:"ghost",onClick:()=>k(!1),children:"Cancelar"})]}):e.jsx(l,{variant:"outline",onClick:X,leftIcon:e.jsx(ge,{size:16}),disabled:n||!a?.length,children:e.jsx("span",{className:"hidden sm:inline",children:"Reordenar"})}),e.jsxs(l,{variant:"primary",onClick:()=>x("/planos/novo"),leftIcon:e.jsx(L,{size:16}),children:[e.jsx("span",{className:"hidden sm:inline",children:"Novo Plano"}),e.jsx("span",{className:"sm:hidden",children:"Novo"})]})]})]}),E&&e.jsx(d,{className:"p-4",children:e.jsx("div",{className:"flex flex-wrap gap-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-[#6b5d57] dark:text-[#B8AEA4] mb-1",children:"Status"}),e.jsxs("select",{value:v,onChange:t=>Z(t.target.value),className:"h-9 px-3 rounded-lg border border-[#d8ccc4] dark:border-[#2D2925] bg-white dark:bg-[#1A1715] text-[#2a2420] dark:text-[#F5F0EB] text-sm focus:outline-none focus:border-[#db6f57] dark:focus:border-[#E07A62]",children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"ativo",children:"Ativos"}),e.jsx("option",{value:"inativo",children:"Inativos"})]})]})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-[#6b5d57] dark:text-[#7A716A]",children:n?"Carregando...":`${A.length} planos encontrados`}),i&&e.jsx("p",{className:"text-sm text-[#db6f57] dark:text-[#E07A62] font-medium",children:"Modo de reordenação ativo"})]}),n?e.jsx(d,{className:"p-6",children:e.jsx(le,{rows:5})}):p.length===0?e.jsx(U,{icon:e.jsx(u,{size:48}),title:"Nenhum plano",description:m?"Nenhum resultado para sua busca.":"Nenhum plano cadastrado ainda.",action:e.jsx(l,{onClick:()=>x("/planos/novo"),leftIcon:e.jsx(L,{size:16}),children:"Criar primeiro plano"})}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"hidden lg:block overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-[#d8ccc4] dark:border-[#2D2925]",children:[i&&e.jsx("th",{className:"w-20 px-3 py-3 text-xs font-semibold uppercase tracking-wider text-[#6b5d57] dark:text-[#7A716A] text-center",children:"Ordem"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold uppercase tracking-wider text-[#6b5d57] dark:text-[#7A716A]",children:"Plano"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold uppercase tracking-wider text-[#6b5d57] dark:text-[#7A716A]",children:"Código"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold uppercase tracking-wider text-[#6b5d57] dark:text-[#7A716A]",children:"Status"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold uppercase tracking-wider text-[#6b5d57] dark:text-[#7A716A]",children:"Mensal"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold uppercase tracking-wider text-[#6b5d57] dark:text-[#7A716A]",children:"Anual"}),e.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold uppercase tracking-wider text-[#6b5d57] dark:text-[#7A716A]",children:"Orgs"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold uppercase tracking-wider text-[#6b5d57] dark:text-[#7A716A]",children:"Ações"})]})}),e.jsx("tbody",{children:p.map((t,s)=>e.jsxs("tr",{className:j("border-b border-[#d8ccc4]/50 dark:border-[#2D2925]/50 transition-colors",!i&&"hover:bg-[#faf8f6] dark:hover:bg-[#2D2925]/30 cursor-pointer",!t.ativo&&"opacity-60"),onClick:()=>!i&&x(`/planos/${t.id}`),children:[i&&e.jsx("td",{className:"px-3 py-3",onClick:c=>c.stopPropagation(),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("button",{onClick:()=>B(s),disabled:s===0,className:"p-1 rounded hover:bg-[#faf8f6] dark:hover:bg-[#2D2925] disabled:opacity-30 text-[#6b5d57] dark:text-[#B8AEA4]",children:e.jsx(O,{size:14})}),e.jsx("span",{className:"text-xs text-[#6b5d57] dark:text-[#7A716A] min-w-[20px] text-center",children:s+1}),e.jsx("button",{onClick:()=>F(s),disabled:s===p.length-1,className:"p-1 rounded hover:bg-[#faf8f6] dark:hover:bg-[#2D2925] disabled:opacity-30 text-[#6b5d57] dark:text-[#B8AEA4]",children:e.jsx(I,{size:14})})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center shrink-0",style:{backgroundColor:t.cor?`${t.cor}15`:"#d8ccc415",color:t.cor||"#6b5d57"},children:e.jsx(T,{iconName:t.icone,cor:t.cor})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-[#2a2420] dark:text-[#F5F0EB]",children:t.nome}),t.popular&&e.jsxs("span",{className:"flex items-center gap-0.5 text-[10px] font-medium text-amber-600 dark:text-amber-400",children:[e.jsx(w,{size:10,className:"fill-current"}),"Popular"]})]}),t.tagline&&e.jsx("p",{className:"text-xs text-[#6b5d57] dark:text-[#7A716A] truncate max-w-[200px]",children:t.tagline})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("code",{className:"text-xs font-mono px-2 py-1 rounded bg-[#faf8f6] dark:bg-[#2D2925] text-[#6b5d57] dark:text-[#B8AEA4]",children:t.codigo})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(D,{variant:t.ativo?"success":"danger",children:t.ativo?"Ativo":"Inativo"})}),e.jsx("td",{className:"px-4 py-3 text-right text-sm font-medium text-[#2a2420] dark:text-[#F5F0EB]",children:y(t.precoMensal)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-[#2a2420] dark:text-[#F5F0EB]",children:y(t.precoAnual)}),t.descontoPercentualAnual&&e.jsxs("span",{className:"ml-1.5 text-[10px] font-medium text-[#4f6f64] dark:text-[#6B8F82]",children:["-",t.descontoPercentualAnual,"%"]})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[e.jsx(P,{size:13,className:"text-[#6b5d57] dark:text-[#7A716A]"}),e.jsx("span",{className:"text-sm text-[#2a2420] dark:text-[#F5F0EB]",children:M(t.totalOrganizacoesUsando)})]})}),e.jsx("td",{className:"px-4 py-3",onClick:c=>c.stopPropagation(),children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:()=>x(`/planos/${t.id}`),className:"p-2 rounded-lg text-[#6b5d57] dark:text-[#B8AEA4] hover:bg-[#faf8f6] dark:hover:bg-[#2D2925] hover:text-[#db6f57] dark:hover:text-[#E07A62] transition-colors",title:"Editar",children:e.jsx($,{size:15})}),e.jsx("button",{onClick:()=>S(t),disabled:t.ativo&&t.totalOrganizacoesUsando>0,className:j("p-2 rounded-lg transition-colors",t.ativo&&t.totalOrganizacoesUsando>0?"opacity-30 cursor-not-allowed text-[#6b5d57] dark:text-[#7A716A]":t.ativo?"text-[#6b5d57] dark:text-[#B8AEA4] hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-500 dark:hover:text-red-400":"text-[#6b5d57] dark:text-[#B8AEA4] hover:bg-[#4f6f64]/10 hover:text-[#4f6f64] dark:hover:text-[#6B8F82]"),title:t.ativo&&t.totalOrganizacoesUsando>0?`Não pode desativar: ${t.totalOrganizacoesUsando} organização(ões) usando`:t.ativo?"Desativar":"Ativar",children:t.ativo?e.jsx(R,{size:15}):e.jsx(C,{size:15})})]})})]},t.id))})]})})}),e.jsx("div",{className:"lg:hidden space-y-3",children:p.map((t,s)=>e.jsxs(d,{hover:!i,className:j("p-4",!i&&"cursor-pointer",!t.ativo&&"opacity-60"),onClick:()=>!i&&x(`/planos/${t.id}`),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[i&&e.jsxs("div",{className:"flex flex-col items-center gap-0.5",onClick:c=>c.stopPropagation(),children:[e.jsx("button",{onClick:()=>B(s),disabled:s===0,className:"p-0.5 disabled:opacity-30",children:e.jsx(O,{size:14})}),e.jsx("span",{className:"text-[10px] text-[#6b5d57] dark:text-[#7A716A]",children:s+1}),e.jsx("button",{onClick:()=>F(s),disabled:s===p.length-1,className:"p-0.5 disabled:opacity-30",children:e.jsx(I,{size:14})})]}),e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center shrink-0",style:{backgroundColor:t.cor?`${t.cor}15`:"#d8ccc415",color:t.cor||"#6b5d57"},children:e.jsx(T,{iconName:t.icone,cor:t.cor})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-[#2a2420] dark:text-[#F5F0EB]",children:t.nome}),t.popular&&e.jsx(w,{size:12,className:"text-amber-500 fill-amber-500"})]}),e.jsx("code",{className:"text-[10px] font-mono text-[#6b5d57] dark:text-[#7A716A]",children:t.codigo})]})]}),e.jsx(D,{variant:t.ativo?"success":"danger",children:t.ativo?"Ativo":"Inativo"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-xs text-[#6b5d57] dark:text-[#B8AEA4]",children:[e.jsxs("span",{className:"font-medium text-[#2a2420] dark:text-[#F5F0EB]",children:[y(t.precoMensal),"/mês"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(P,{size:12})," ",t.totalOrganizacoesUsando]})]}),!i&&e.jsxs("div",{className:"flex items-center gap-1",onClick:c=>c.stopPropagation(),children:[e.jsx("button",{onClick:()=>x(`/planos/${t.id}`),className:"p-2 rounded-lg text-[#6b5d57] dark:text-[#B8AEA4] hover:text-[#db6f57] dark:hover:text-[#E07A62]",children:e.jsx($,{size:14})}),e.jsx("button",{onClick:()=>S(t),disabled:t.ativo&&t.totalOrganizacoesUsando>0,className:j("p-2 rounded-lg",t.ativo&&t.totalOrganizacoesUsando>0?"opacity-30 cursor-not-allowed":t.ativo?"text-[#6b5d57] hover:text-red-500":"text-[#6b5d57] hover:text-[#4f6f64]"),children:t.ativo?e.jsx(R,{size:14}):e.jsx(C,{size:14})})]})]})]},t.id))})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>h(null),children:e.jsxs(d,{className:"w-full max-w-sm p-6",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:j("w-10 h-10 rounded-full flex items-center justify-center",r.type==="desativar"?"bg-red-100 dark:bg-red-900/30":"bg-[#4f6f64]/15 dark:bg-[#6B8F82]/15"),children:r.type==="desativar"?e.jsx(je,{size:20,className:"text-red-500 dark:text-red-400"}):e.jsx(C,{size:20,className:"text-[#4f6f64] dark:text-[#6B8F82]"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-[#2a2420] dark:text-[#F5F0EB]",children:r.type==="desativar"?"Desativar plano":"Ativar plano"}),e.jsx("p",{className:"text-sm text-[#6b5d57] dark:text-[#B8AEA4]",children:r.type==="desativar"?"Este plano será desativado e não aparecerá no site público.":"Este plano será reativado e ficará disponível no site público."})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(l,{variant:"ghost",onClick:()=>h(null),children:"Cancelar"}),e.jsx(l,{variant:r.type==="desativar"?"danger":"secondary",onClick:J,leftIcon:r.type==="desativar"?e.jsx(W,{size:16}):e.jsx(ue,{size:16}),children:r.type==="desativar"?"Desativar":"Ativar"})]})]})})]})}export{Ue as PlanosList};
